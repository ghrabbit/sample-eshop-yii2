{{> edit/header}}
<form class="form-horizontal" role="form" method="post" action="{{action}}" id="{{formId}}" name="{{formName}}">
  {{> form/header}}
  <input type="hidden" name="id" value="{{model.id}}">
  <div id="categories">
	 {{#model.categories}} 
	   <input type="hidden" name="categories[]" id="cid{{id}}" value="{{id}}">
	 {{/model.categories}}
  </div>
  <div class="form-group">
    <label for="inputTitle" class="col-sm-3 control-label">{{labels.title}} *</label>
    <div class="col-sm-9">
      <input type="text" class="form-control" name="title" id="inputTitle" size=60 maxlength=32 value="{{model.title}}">
    </div>
  </div>
  <div class="form-group">
		<label for="inputDescription" class="col-sm-3 control-label">{{labels.description}}</label>
		<div class="col-sm-9">
			<textarea class="form-control" name="description" id="inputDescription" placeholder="Description" rows="6" cols="50">{{model.description}}</textarea>
		</div>	
  </div>

  <div class="form-group">
		<label class="col-sm-3 control-label">{{labels.categories}}</label>
		<div class="col-sm-9">
			{{{categoryTree}}}
		</div>	
  </div>	
  <div class="form-group">
		<label for="inputPrice" class="col-sm-3 control-label">{{labels.price}}</label>
		<div class="col-sm-9">
			<input type="text" class="form-control" name="price" id="inputPrice" value="{{model.price}}">
		</div>	
  </div>
  <div class="form-group">
		<label for="inputImgFile" class="col-sm-3 control-label">{{labels.img_file}}</label>
		<div class="col-sm-9">
			<input type="text" class="form-control" name="img_file" id="inputImgFile" value="{{model.img_file}}">
		</div>	
  </div>  
  <div class="form-group">
    <div class="col-sm-offset-3 col-sm-9">
      <button type="submit" class="btn btn-default">{{labels.submit}}</button>
    </div>
  </div>
</form><!-- form -->
</div><!-- form -->
<script language="Javascript">
	$(function() {
		$('#categoryTree').on('nodeSelected',function(event, node)
		{
			id = node.data['id'];
			$('#categories').prepend('<input type="hidden" name="categories[]" id="cid'+id+'" value="'+id+'">');
			//$('#inputCategoryId').html(node.text);
			//console.log("prepended " + node.text);
		});
		
		$('#categoryTree').on('nodeUnselected',function(event, node)
		{
			$('#cid'+node.data['id']).remove();
			//$('#inputCategoryId').html('');
			//console.log("removed " + node.text);
		});
    });
</script>
